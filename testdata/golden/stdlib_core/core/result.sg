pragma no_std;
// Core Result type, a tagged union for recoverable errors.

// stub for test
// PLEASE REMOVE THIS IF U COPY TO CORE MODULE
pub fn default<T>() -> T;
pub fn exit<E>(e: E) -> nothing;

pub type Error = { message: string, code: uint };

pub tag Ok<T>(T);
pub tag Err<E>(E);
pub type Result<T, E> = Ok(T) | Err(E);

extern<Result<T, E>> {
    pub fn safe<T, E>(self: Result<T, E>) -> T {
        compare self {
            Ok(v) => v;
            Err(_) => default::<T>();
        };
    }

    pub fn exit<T, E>(self: Result<T, E>) -> nothing {
        compare self {
            Ok(_) => return nothing;
            Err(e) => exit(e);
        };
    }
}
