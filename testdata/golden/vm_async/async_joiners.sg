@entrypoint
fn main() -> int {
    let t = task async {
        checkpoint().await();
        checkpoint().await();
        return 7;
    };
    let t1 = t.clone();

    let j1 = task joiner("J1", t);
    let j2 = task joiner("J2", t1);

    let _ = j1.await();
    let _ = j2.await();
    return 0;
}

async fn joiner(label: string, t: Task<int>) -> int {
    let result = t.await();
    compare result {
        Success(v) => print(label + "=" + (v to string));
        Cancelled() => print(label + "=cancelled");
    };
    return 0;
}
