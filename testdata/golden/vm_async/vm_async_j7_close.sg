async fn receiver(ch: own Channel<int>) -> int {
    let v = ch.recv();
    compare v {
        Some(x) => print("v=" + (x to string));
        nothing => print("closed");
    };
    return 0;
}

async fn closer(ch: own Channel<int>) -> int {
    checkpoint().await();
    ch.close();
    return 0;
}

@entrypoint
fn main() -> int {
    let ch = make_channel::<int>(0);

    let recv_ch = ch;
    let close_ch = ch;
    let recv_task = task receiver(recv_ch);
    let close_task = task closer(close_ch);

    let _ = recv_task.await();
    let _ = close_task.await();
    return 0;
}
