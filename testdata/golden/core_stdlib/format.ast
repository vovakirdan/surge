format.sg (span: 1:1-124:1)
├─ Item[0]: Tag (span: 3:1-3:25)
│  ├─ Name: FmtStr
│  ├─ Visibility: public
│  └─ Payload: &string
├─ Item[1]: Tag (span: 4:1-4:21)
│  ├─ Name: FmtInt
│  ├─ Visibility: public
│  └─ Payload: int
├─ Item[2]: Tag (span: 5:1-5:23)
│  ├─ Name: FmtUInt
│  ├─ Visibility: public
│  └─ Payload: uint
├─ Item[3]: Tag (span: 6:1-6:25)
│  ├─ Name: FmtFloat
│  ├─ Visibility: public
│  └─ Payload: float
├─ Item[4]: Tag (span: 7:1-7:23)
│  ├─ Name: FmtBool
│  ├─ Visibility: public
│  └─ Payload: bool
├─ Item[5]: Type (span: 9:1-9:99)
│  ├─ Name: FmtArg
│  ├─ Kind: Union
│  ├─ Visibility: public
│  └─ Union:
│     ├─ Member[0]: FmtStr(&string)
│     ├─ Member[1]: FmtInt(int)
│     ├─ Member[2]: FmtUInt(uint)
│     ├─ Member[3]: FmtFloat(float)
│     └─ Member[4]: FmtBool(bool)
├─ Item[6]: Fn (span: 11:1-13:2)
│  ├─ Name: fmt_arg
│  ├─ Params: (s: &string)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 11:38-13:2)
│        └─ Stmt[0]: Return (span: 12:5-12:22)
│           └─ Expr: expr#3: FmtStr(s)
├─ Item[7]: Fn (span: 15:1-18:2)
│  ├─ Name: fmt_arg
│  ├─ Params: (x: int)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 16:34-18:2)
│        └─ Stmt[0]: Return (span: 17:5-17:22)
│           └─ Expr: expr#6: FmtInt(x)
├─ Item[8]: Fn (span: 20:1-23:2)
│  ├─ Name: fmt_arg
│  ├─ Params: (x: uint)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 21:35-23:2)
│        └─ Stmt[0]: Return (span: 22:5-22:23)
│           └─ Expr: expr#9: FmtUInt(x)
├─ Item[9]: Fn (span: 25:1-28:2)
│  ├─ Name: fmt_arg
│  ├─ Params: (x: float)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 26:36-28:2)
│        └─ Stmt[0]: Return (span: 27:5-27:24)
│           └─ Expr: expr#12: FmtFloat(x)
├─ Item[10]: Fn (span: 30:1-33:2)
│  ├─ Name: fmt_arg
│  ├─ Params: (x: bool)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 31:35-33:2)
│        └─ Stmt[0]: Return (span: 32:5-32:23)
│           └─ Expr: expr#15: FmtBool(x)
├─ Item[11]: Fn (span: 35:1-37:2)
│  ├─ Name: fmt_arg_int
│  ├─ Params: (x: int)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 35:38-37:2)
│        └─ Stmt[0]: Return (span: 36:5-36:22)
│           └─ Expr: expr#18: FmtInt(x)
├─ Item[12]: Fn (span: 39:1-41:2)
│  ├─ Name: fmt_arg_uint
│  ├─ Params: (x: uint)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 39:40-41:2)
│        └─ Stmt[0]: Return (span: 40:5-40:23)
│           └─ Expr: expr#21: FmtUInt(x)
├─ Item[13]: Fn (span: 43:1-45:2)
│  ├─ Name: fmt_arg_float
│  ├─ Params: (x: float)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 43:42-45:2)
│        └─ Stmt[0]: Return (span: 44:5-44:24)
│           └─ Expr: expr#24: FmtFloat(x)
├─ Item[14]: Fn (span: 47:1-49:2)
│  ├─ Name: fmt_arg_bool
│  ├─ Params: (x: bool)
│  ├─ Return: FmtArg
│  └─ Body:
│     └─ Stmt[0]: Block (span: 47:40-49:2)
│        └─ Stmt[0]: Return (span: 48:5-48:23)
│           └─ Expr: expr#27: FmtBool(x)
├─ Item[15]: Fn (span: 51:1-59:2)
│  ├─ Name: fmt_arg_to_string
│  ├─ Params: (arg: &FmtArg)
│  ├─ Return: string
│  └─ Body:
│     └─ Stmt[0]: Block (span: 51:46-59:2)
│        └─ Stmt[0]: Return (span: 52:5-58:7)
│           └─ Expr: expr#56: compare *arg { 5 arms }
└─ Item[16]: Fn (span: 61:1-123:2)
   ├─ Name: format
   ├─ Params: (fmt: string, ...args: FmtArg)
   ├─ Return: string
   └─ Body:
      └─ Stmt[0]: Block (span: 61:55-123:2)
         ├─ Stmt[0]: Let (span: 62:5-62:45)
         │  ├─ Name: fmt_len
         │  ├─ Mutable: false
         │  ├─ Type: int
         │  └─ Value: expr#60: string_len_int(&fmt)
         ├─ Stmt[1]: Let (span: 63:5-63:46)
         │  ├─ Name: arg_count
         │  ├─ Mutable: false
         │  ├─ Type: int
         │  └─ Value: expr#64: args.__len() to int
         ├─ Stmt[2]: Let (span: 64:5-64:32)
         │  ├─ Name: arg_index
         │  ├─ Mutable: true
         │  ├─ Type: int
         │  └─ Value: expr#65: 0
         ├─ Stmt[3]: Let (span: 65:5-65:30)
         │  ├─ Name: out
         │  ├─ Mutable: true
         │  ├─ Type: string
         │  └─ Value: expr#66: ""
         ├─ Stmt[4]: Let (span: 66:5-66:24)
         │  ├─ Name: i
         │  ├─ Mutable: true
         │  ├─ Type: int
         │  └─ Value: expr#67: 0
         ├─ Stmt[5]: Let (span: 67:5-67:32)
         │  ├─ Name: seg_start
         │  ├─ Mutable: true
         │  ├─ Type: int
         │  └─ Value: expr#68: 0
         ├─ Stmt[6]: While (span: 69:5-114:6)
         │  ├─ Cond: expr#71: (i < fmt_len)
         │  └─ Body:
Block (span: 69:23-114:6)
         │     ├─ Stmt[0]: Let (span: 70:9-70:33)
         │     │  ├─ Name: ch
         │     │  ├─ Mutable: false
         │     │  ├─ Type: uint32
         │     │  └─ Value: expr#74: fmt[i]
         │     ├─ Stmt[1]: If (span: 71:9-100:10)
         │     │  ├─ Cond: expr#79: (ch == ((123) to uint32))
         │     │  ├─ Then:
Block (span: 71:31-100:10)
         │     │  │  ├─ Stmt[0]: If (span: 72:13-74:14)
         │     │  │  │  ├─ Cond: expr#84: (((i + 1)) >= fmt_len)
         │     │  │  │  ├─ Then:
Block (span: 72:33-74:14)
         │     │  │  │  │  └─ Stmt[0]: Expr (span: 73:17-73:65)
         │     │  │  │  │     └─ Expr: expr#87: panic("format: unmatched '{' in format string")
         │     │  │  │  └─ Else: <none>
         │     │  │  ├─ Stmt[1]: Let (span: 75:13-75:43)
         │     │  │  │  ├─ Name: next
         │     │  │  │  ├─ Mutable: false
         │     │  │  │  ├─ Type: uint32
         │     │  │  │  └─ Value: expr#92: fmt[(i + 1)]
         │     │  │  ├─ Stmt[2]: If (span: 76:13-84:14)
         │     │  │  │  ├─ Cond: expr#97: (next == ((123) to uint32))
         │     │  │  │  ├─ Then:
Block (span: 76:37-84:14)
         │     │  │  │  │  ├─ Stmt[0]: If (span: 77:17-79:18)
         │     │  │  │  │  │  ├─ Cond: expr#100: (i > seg_start)
         │     │  │  │  │  │  ├─ Then:
Block (span: 77:34-79:18)
         │     │  │  │  │  │  │  └─ Stmt[0]: Expr (span: 78:21-78:53)
         │     │  │  │  │  │  │     └─ Expr: expr#110: (out = ((out + fmt[[seg_start..i]])))
         │     │  │  │  │  │  └─ Else: <none>
         │     │  │  │  │  ├─ Stmt[1]: Expr (span: 80:17-80:33)
         │     │  │  │  │  │  └─ Expr: expr#115: (out = ((out + "{")))
         │     │  │  │  │  ├─ Stmt[2]: Expr (span: 81:17-81:27)
         │     │  │  │  │  │  └─ Expr: expr#120: (i = ((i + 2)))
         │     │  │  │  │  ├─ Stmt[3]: Expr (span: 82:17-82:31)
         │     │  │  │  │  │  └─ Expr: expr#123: (seg_start = i)
         │     │  │  │  │  └─ Stmt[4]: Continue (span: 83:17-83:26)
         │     │  │  │  │     └─ (no additional data)
         │     │  │  │  └─ Else: <none>
         │     │  │  ├─ Stmt[3]: If (span: 85:13-98:14)
         │     │  │  │  ├─ Cond: expr#128: (next == ((125) to uint32))
         │     │  │  │  ├─ Then:
Block (span: 85:37-98:14)
         │     │  │  │  │  ├─ Stmt[0]: If (span: 86:17-88:18)
         │     │  │  │  │  │  ├─ Cond: expr#131: (i > seg_start)
         │     │  │  │  │  │  ├─ Then:
Block (span: 86:34-88:18)
         │     │  │  │  │  │  │  └─ Stmt[0]: Expr (span: 87:21-87:53)
         │     │  │  │  │  │  │     └─ Expr: expr#141: (out = ((out + fmt[[seg_start..i]])))
         │     │  │  │  │  │  └─ Else: <none>
         │     │  │  │  │  ├─ Stmt[1]: If (span: 89:17-91:18)
         │     │  │  │  │  │  ├─ Cond: expr#144: (arg_index >= arg_count)
         │     │  │  │  │  │  ├─ Then:
Block (span: 89:43-91:18)
         │     │  │  │  │  │  │  └─ Stmt[0]: Expr (span: 90:21-90:77)
         │     │  │  │  │  │  │     └─ Expr: expr#147: panic("format: not enough arguments for format string")
         │     │  │  │  │  │  └─ Else: <none>
         │     │  │  │  │  ├─ Stmt[2]: Let (span: 92:17-92:74)
         │     │  │  │  │  │  ├─ Name: arg_str
         │     │  │  │  │  │  ├─ Mutable: false
         │     │  │  │  │  │  ├─ Type: string
         │     │  │  │  │  │  └─ Value: expr#152: fmt_arg_to_string(args[arg_index])
         │     │  │  │  │  ├─ Stmt[3]: Expr (span: 93:17-93:37)
         │     │  │  │  │  │  └─ Expr: expr#157: (out = ((out + arg_str)))
         │     │  │  │  │  ├─ Stmt[4]: Expr (span: 94:17-94:43)
         │     │  │  │  │  │  └─ Expr: expr#162: (arg_index = ((arg_index + 1)))
         │     │  │  │  │  ├─ Stmt[5]: Expr (span: 95:17-95:27)
         │     │  │  │  │  │  └─ Expr: expr#167: (i = ((i + 2)))
         │     │  │  │  │  ├─ Stmt[6]: Expr (span: 96:17-96:31)
         │     │  │  │  │  │  └─ Expr: expr#170: (seg_start = i)
         │     │  │  │  │  └─ Stmt[7]: Continue (span: 97:17-97:26)
         │     │  │  │  │     └─ (no additional data)
         │     │  │  │  └─ Else: <none>
         │     │  │  └─ Stmt[4]: Expr (span: 99:13-99:61)
         │     │  │     └─ Expr: expr#173: panic("format: unmatched '{' in format string")
         │     │  └─ Else: <none>
         │     ├─ Stmt[2]: If (span: 101:9-112:10)
         │     │  ├─ Cond: expr#178: (ch == ((125) to uint32))
         │     │  ├─ Then:
Block (span: 101:31-112:10)
         │     │  │  ├─ Stmt[0]: If (span: 102:13-110:14)
         │     │  │  │  ├─ Cond: expr#193: (((((i + 1)) < fmt_len)) && ((fmt[(i + 1)] == ((125) to uint32))))
         │     │  │  │  ├─ Then:
Block (span: 102:62-110:14)
         │     │  │  │  │  ├─ Stmt[0]: If (span: 103:17-105:18)
         │     │  │  │  │  │  ├─ Cond: expr#196: (i > seg_start)
         │     │  │  │  │  │  ├─ Then:
Block (span: 103:34-105:18)
         │     │  │  │  │  │  │  └─ Stmt[0]: Expr (span: 104:21-104:53)
         │     │  │  │  │  │  │     └─ Expr: expr#206: (out = ((out + fmt[[seg_start..i]])))
         │     │  │  │  │  │  └─ Else: <none>
         │     │  │  │  │  ├─ Stmt[1]: Expr (span: 106:17-106:33)
         │     │  │  │  │  │  └─ Expr: expr#211: (out = ((out + "}")))
         │     │  │  │  │  ├─ Stmt[2]: Expr (span: 107:17-107:27)
         │     │  │  │  │  │  └─ Expr: expr#216: (i = ((i + 2)))
         │     │  │  │  │  ├─ Stmt[3]: Expr (span: 108:17-108:31)
         │     │  │  │  │  │  └─ Expr: expr#219: (seg_start = i)
         │     │  │  │  │  └─ Stmt[4]: Continue (span: 109:17-109:26)
         │     │  │  │  │     └─ (no additional data)
         │     │  │  │  └─ Else: <none>
         │     │  │  └─ Stmt[1]: Expr (span: 111:13-111:61)
         │     │  │     └─ Expr: expr#222: panic("format: unmatched '}' in format string")
         │     │  └─ Else: <none>
         │     └─ Stmt[3]: Expr (span: 113:9-113:19)
         │        └─ Expr: expr#227: (i = ((i + 1)))
         ├─ Stmt[7]: If (span: 116:5-118:6)
         │  ├─ Cond: expr#230: (seg_start < fmt_len)
         │  ├─ Then:
Block (span: 116:28-118:6)
         │  │  └─ Stmt[0]: Expr (span: 117:9-117:47)
         │  │     └─ Expr: expr#240: (out = ((out + fmt[[seg_start..fmt_len]])))
         │  └─ Else: <none>
         ├─ Stmt[8]: If (span: 119:5-121:6)
         │  ├─ Cond: expr#243: (arg_index != arg_count)
         │  ├─ Then:
Block (span: 119:31-121:6)
         │  │  └─ Stmt[0]: Expr (span: 120:9-120:63)
         │  │     └─ Expr: expr#246: panic("format: too many arguments for format string")
         │  └─ Else: <none>
         └─ Stmt[9]: Return (span: 122:5-122:16)
            └─ Expr: expr#247: out
