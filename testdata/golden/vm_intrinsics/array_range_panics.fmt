fn write_line(s: string) -> nothing {
    let nl = "\n";
    rt_write_stdout(rt_string_ptr(&s), rt_string_len_bytes(&s));
    rt_write_stdout(rt_string_ptr(&nl), 1:uint);
}

fn print_int(n: int) -> nothing {
    write_line(n to string);
}

fn sum_range(r: Range<int>) -> int {
    let mut it: Range<int> = r;
    let mut total: int = 0;
    while true {
        let v: int = compare it.next() {
            Some(v) => v;
            _ => -1;
        };
        if v < 0 {
            break;
        }
        total = total + v;
    }
    return total;
}

@entrypoint
fn main() -> int {
    let a0: int[] = [1, 2, 3, 4];
    print_int(sum_range(a0.__range()));
    let a1: int[] = [1, 2, 3, 4];
    let view = a1[[1..3]];
    print_int(sum_range(view.__range()));
    let f: int[3] = [5, 6, 7];
    print_int(sum_range(f.__range()));
    let a2: int[] = [1, 2, 3, 4];
    let mut it: Range<int> = a2.__range();
    let mut s: int = 0;
    while true {
        let v: int = compare it.next() {
            Some(v) => v;
            _ => -1;
        };
        if v < 0 {
            break;
        }
        s = s + v;
        if s > 3 {
            break;
        }
    }
    print_int(s);
    return 0;
}
