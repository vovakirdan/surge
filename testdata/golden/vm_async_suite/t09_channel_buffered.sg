async fn sender(ch: own Channel<int>) -> int {
    ch.send(10);
    ch.send(20);
    print("sender done");
    return 0;
}

async fn receiver(ch: own Channel<int>) -> int {
    let a = ch.recv();
    let b = ch.recv();
    compare a {
        Some(x) => print("a=" + (x to string));
        nothing => print("a=nothing");
    };
    compare b {
        Some(x) => print("b=" + (x to string));
        nothing => print("b=nothing");
    };
    return 0;
}

@entrypoint
fn main() -> int {
    let ch = make_channel::<int>(1);

    let sender_ch = ch;
    let recv_ch = ch;
    let sender_task = task sender(sender_ch);
    let receiver_task = task receiver(recv_ch);

    let _ = sender_task.await();
    let _ = receiver_task.await();
    return 0;
}
