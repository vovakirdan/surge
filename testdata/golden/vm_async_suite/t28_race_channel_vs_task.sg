@entrypoint
fn main() -> int {
    let r = (async {
        let ch = make_channel<int>(1);
        ch.send(9);

        let t = spawn async {
            sleep(100).await();
            print("t done");
            return 0;
        };

        let v = race {
            ch.recv() => 1;
            t.await() => 2;
        };
        return v;
    }).await();

    compare r {
        Success(v) => print("v=" + (v to string)),
        Cancelled => print("cancelled"),
    }

    let guard = spawn async {
        sleep(200).await();
        return 0;
    };
    let _ = guard.await();
    return 0;
}
